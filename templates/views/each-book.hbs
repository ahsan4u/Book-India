<!DOCTYPE html>
<html lang="en">
<head>
    {{>head}}
    
    <link rel="stylesheet" href="/stylesheets/other.css">
    <link rel="stylesheet" href="/stylesheets/book.css">

    <link rel="stylesheet" href="/stylesheets/each-book.css">
</head>
<body>
    {{>top}}

<div class="items-container">
    <table id="first-table">
        <tr id="first-row">
            {{#if book.image}}
                <td rowspan="5" id="img-td">
                    <img id="imgaeTemp" src="/books/{{book.image}}" alt="">
                    <button id="likeBtn" onclick="addToLike('{{book._id}}');"></button>
                </td>
            {{else}}
                <td rowspan="5" id="img-td"><img id="imgaeTemp" src="/books/not-found.png" alt="gn"></td>
            {{/if}}
            <td colspan="2" id="book-names-td">
                <h1 id="book-name-heading">{{book.name}}</h1>
            </td>
        </tr>

        <tr id="second-row">
            <td colspan="2">
                <div class="names-container">
                    {{#if book.publishedDate}}<p>Released: {{book.publishedDate}}</p>{{/if}}
                    {{#if book.auther}}<p>By: <span> {{book.auther}} </span><small> (Auther)</small></p>{{/if}}
                    {{#if book.publisher}}<p id="publisher">Publisher: <span>{{book.publisher}}</span></p>{{/if}}
                </div>
            </td>
        </tr>

        <tr id="third-row">
            <td>
                <div class="price-container">
                    <p id="new-price">₹{{book.price}}</p>
                    <p id="price-before">M.R.P.: {{book.price}}</p>
                    <p id="price-save">Save: ₹340 <span>(40%)</span></p>
                </div>
            </td>

            <td>   
                <div class="buy-container">
                    <label for="qty">Qty: </label>
                    <select name="qty" id="qty">
                        <option value="1">1</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                        <option value="4">4</option>
                        <option value="5">5</option>
                        <option value="6">6</option>
                    </select>
                    {{#if user}}
                        <input id="cart" onclick="addToCart('{{book._id}}');" type="submit" value="add to cart">
                        <input id="buy" type="button" value="Buy Now">
                    {{else}}
                        <a href="/sign-in-up"><input id="cart" type="button" value="Add To Cart"></a>
                        <input id="buy" type="button" value="Buy Now">
                    {{/if}}
                </div> 
            </td>
        </tr>

        <tr id="fourth-row">
            <td colspan="2"><h2 id="about-book">Book Description:</h2></td>
        </tr>

        <tr id="fifth-row">
            <td colspan="2"><div class="description">{{book.description}}</div></td>
        </tr>
    </table>
    
    <table class="specification-table">
        <tr id="first-row">
            <td colspan="4"><h2 id="specification-heading">Book Specification</h2></td>
        </tr>

        <tr id="second-row">
            <td>
                <div class="specification-content">
                    <ul>
                        {{#if book.isbn}}<li><b>ISBN-13</b></li>{{/if}}
                        {{#if book.publisher}}<li><b>Publisher</b></li>{{/if}}
                        {{#if book.binding}}<li><b>Binding</b></li>{{/if}}
                        {{#if book.language}}<li><b>Language</b></li>{{/if}}
                    </ul>
                </div>

            <td>
                <div class="specification-result">
                    {{#if book.isbn}}<p>{{book.isbn}}</p>{{/if}}
                    {{#if book.publisher}}<p>{{book.publisher}}</p>{{/if}}
                    {{#if book.binding}}<p>{{book.binding}}</p>{{/if}}
                    {{#if book.language}}<p>{{book.language}}</p>{{/if}}
                </div>  
            </td>

            <td>
                <div class="specification-content">
                    <ul>
                        {{#if book.pages}} <li><b>No. of Pages</b></li>{{/if}}
                        {{#if book.publishedDate}} <li><b>Publisher Date</b></li>{{/if}}
                        {{#if book.width}} <li><b>Width</b></li>{{/if}}
                        {{#if book.height}} <li><b>Height</b></li>{{/if}}
                    </ul>
                </div>
            </td>

            <td>
                <div class="specification-result">
                    {{#if book.pages}} <p>{{book.pages}}</p> {{/if}}
                    {{#if book.publishedDate}} <p>{{book.publishedDate}}</p> {{/if}}
                    {{#if book.width}} <p>{{book.width}}mm</p> {{/if}}
                    {{#if book.height}} <p>{{book.height}}mm</p> {{/if}}
                </div>
            </td>
        </tr>
    </table>

    <div class="middleware">
        {{!-- Books with the same Auther --}}
        <a class="see-more-btn" href="/books">See More...</a>   
        <h2 id="categorie-heading">Books With the same Auther</h2>
        <img src="/img-controller/icons/right-arrow.png" alt=">" class="right-arrow">
        <img src="/img-controller/icons/left-arrow.png" alt="<" class="left-arrow">
    
        <div class="scroll">
            {{#each sameAuther}}
                <div class="item">
                    <a id="bookLink" href="/books/{{_id}}">
                        <img id="book" src="/books/{{image}}" alt="{{image}}"><br>
                        <div class="deal-msg"><small>Up to 59% off</small></div><span style="color: red;"><small>Deal</small></span><br>
                        <span id="price">{{price}}₹</span>
                        <span id="book-name">{{name}}</span>
                    </a>
                </div>
            {{/each}}
        </div>
    </div>
</div> 

    {{>navbarScrollEffect}}   
    <script src="/scripts/index.js"></script>
    <script>
        function addToCart(bookId) {
          fetch(`/add-to-cart/${bookId}`,
           {
               method: 'post',
               headers: { 'Content-Type': `application/json` }
           })
           .then((respone)=> {
           if(!respone.ok) {
               console.log('an error is occured');
           }})
           .catch((error)=> {
               alert('error to add item to the cart');
               console.log('script fetch ',error);
           });
        }

        function addToLike(bookId) {
          fetch(`/add-to-likes/${bookId}`,
           {
               method: 'post',
               headers: { 'Content-Type': `application/json` }
           })
           .then((respone)=> {
           if(!respone.ok) {
               console.log('an error is occured');
           }})
           .catch((error)=> {
               alert('You are not logged in');
               console.log('script fetch ',error);
           });
        }
    </script>
</body>
</html>