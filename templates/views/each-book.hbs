 <!DOCTYPE html>
<html lang="en">
<head>
    {{>head}}
    
    <link rel="stylesheet" href="/stylesheets/other.css">
    <link rel="stylesheet" href="/stylesheets/book.css">

    <link rel="stylesheet" href="/stylesheets/product-details.css">
</head>
<body>
    {{>top}}

    <div class="first-row">
      <div class="product-img-container">
        <img class="product-img" src="/books/{{book.image}}" alt="">
      </div>
        
      <div class="product-details-container">
          <h1 class="name-heading">{{book.name}}</h1>
          
          <div class="product-details">
           {{#if book.auther}}<p class="by">By: {{book.auther}} <small> (Auther)</small></p>{{/if}}
          </div>

          <div class="price-qty">
            <p id="new-price">₹{{book.price}} <span class="off-msg">off 20%</span></p>
            <div class="qty-container">
              <span class ="minus" onclick="minus()">-</span>
              <input type="number" name="qty" value="1" class="qty" disabled>
              <span class="plus" onclick="plus()">+</span>
            </div>
          </div>
          
          <p class="price-before">M.R.P.: {{book.price}}</p>
          
          <h2 class="description-heading">Book Description:</h2>

          <div class="description">{{book.description}}</div>   
           <div class="cart-buy-container">  
            {{#if user}}
              <input id="cart" onclick="addToCart('{{book._id}}');" type="submit" value="add to cart">
              <input id="buy" type="button" value="Buy Now">
            {{else}}
              <a href="/sign-in-up"><input id="cart" type="button" value="Add To Cart"></a>
              <input id="buy" type="button" value="Buy Now">
            {{/if}}
           </div> <!-- cart-buy-container -->
      </div> <!-- product-details-container -->
    </div> <!-- first row -->
   
    <div class= "second-row">
     <div class="middleware">
        {{!-- Books with the same Auther --}}
        <a class="see-more-btn" href="/books">See More...</a>   
        <h2 id="categorie-heading">Books With the same Auther</h2>
        <img src="/img-controller/icons/right-arrow.png" alt=">" class="right-arrow">
        <img src="/img-controller/icons/left-arrow.png" alt="<" class="left-arrow">
    
        <div class="scroll">
            {{#each sameAuther}}
                <div class="item">
                    <a id="bookLink" href="/books/{{_id}}">
                        <img id="book" src="/books/{{image}}" alt="{{image}}"><br>
                        {{!-- <div class="deal-msg"><small>Up to 59% off</small></div><br> --}}
                        <span id="auther">{{auther}} <span style="color:lightgray"> auther</span></span><br>
                        <span id="price">{{price}}₹</span>
                        <span id="book-name">{{name}}</span>
                    </a>
                </div> <!-- item -->
            {{/each}}
        </div> <!-- scroll -->
     </div> <!-- middleware -->
    </div> <!-- second row -->

  <!-- {{>footer}} -->

    {{>navbarScrollEffect}}   
    <script src="/scripts/index.js"></script>
    <script>
     let qtyVal = document.querySelector('.qty');
     function plus() {
      if(Number(qtyVal.value) <= 5) {
        qtyVal.value = Number(qtyVal.value) + 1;
      }
     }
     function minus() {
      if(Number(qtyVal.value) >1) {
       qtyVal.value = Number(qtyVal.value) - 1;
      }
     }
        function addToCart(bookId) {
          fetch(`/add-to-cart/${bookId}`,
           {
               method: 'post',
               headers: { 'Content-Type': `application/json` }
           })
           .then((respone)=> {
           if(!respone.ok) {
               console.log('an error is occured');
           }})
           .catch((error)=> {
               alert('error to add item to the cart');
               console.log('script fetch ',error);
           });
        }

        function addToLike(bookId) {
          fetch(`/add-to-likes/${bookId}`,
           {
               method: 'post',
               headers: { 'Content-Type': `application/json` }
           })
           .then((respone)=> {
           if(!respone.ok) {
               console.log('an error is occured');
           }})
           .catch((error)=> {
               alert('You are not logged in');
               console.log('script fetch ',error);
           });
        }
    </script>
</body>
